table_create Logs TABLE_NO_KEY
column_create Logs messages COLUMN_VECTOR|COMPRESS_ZSTD LongText

table_create Terms TABLE_PAT_KEY ShortText \
  --default_tokenizer TokenBigram \
  --normalizer NormalizerAuto

load --table Logs
[
["messages"],
[["Error", "invalid argument"]],
[["Error", "critical error"]],
[["Warning", "not permitted or not found"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]],
[["Notice", "start"]],
[["Notice", "shutdown"]]
]

column_create Terms index COLUMN_INDEX|WITH_POSITION|WITH_SECTION Logs messages

select Logs \
  --match_columns 'scorer_tf_idf(Terms.index)' \
  --query 'err' \
  --output_columns '_score, messages' \
  --sortby -_score
